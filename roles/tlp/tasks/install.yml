---
- name: add gpg key
  apt_key: >
    id="{{ tlp_key_id }}"
    keyserver="{{ tlp_key_keyserver }}"
    state=present
  when: tlp_key_keyserver != false

- name: add repository
  apt_repository: >
    repo="{{ tlp_repository }}"
    state=present
    update_cache=yes
  when: tlp_repository != false

- name: install services
  apt: >
    force=yes
    pkg="{{ item }}"
    state=present
  notify: restart tlp
  with_items: tlp_services

- name: ensure a service is enabled and running
  service: >
    enabled=yes
    name=tlp
    state=started

- name: enable modules
  apt: >
    force=yes
    pkg="{{ item }}"
    state=present
  with_items: tlp_modules
